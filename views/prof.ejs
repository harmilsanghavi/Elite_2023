<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Twitter Clone - Final</title>
  <link rel="stylesheet" href="/style.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
    integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w=="
    crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <input type="text" hidden name="id" id="id">
  <div class="whole-web">
    <div class="container">


      <div class="flexdata">


        <!-- sidebar starts -->
        <div class="sidebar">
          <svg class="svg-icon2"
            style="width: 3em; height: 3em;vertical-align: middle;fill: currentColor;overflow: hidden;"
            viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M962.267429 233.179429q-38.253714 56.027429-92.598857 95.451429 0.585143 7.972571 0.585143 23.990857 0 74.313143-21.723429 148.260571t-65.974857 141.970286-105.398857 120.32-147.456 83.456-184.539429 31.158857q-154.843429 0-283.428571-82.870857 19.968 2.267429 44.544 2.267429 128.585143 0 229.156571-78.848-59.977143-1.170286-107.446857-36.864t-65.170286-91.136q18.870857 2.852571 34.889143 2.852571 24.576 0 48.566857-6.290286-64-13.165714-105.984-63.707429t-41.984-117.394286l0-2.267429q38.838857 21.723429 83.456 23.405714-37.741714-25.161143-59.977143-65.682286t-22.308571-87.990857q0-50.322286 25.161143-93.110857 69.12 85.138286 168.301714 136.265143t212.260571 56.832q-4.534857-21.723429-4.534857-42.276571 0-76.580571 53.979429-130.56t130.56-53.979429q80.018286 0 134.875429 58.294857 62.317714-11.995429 117.174857-44.544-21.138286 65.682286-81.115429 101.741714 53.174857-5.705143 106.276571-28.598857z"
              fill="#857df9" />
          </svg>

          <div class="sidebarOption active">
            <span class="material-icons"> home </span>
            <a href="/login/login">Home</a>
          </div>


          <div class="sidebarOption">
            <span class="material-icons"> perm_identity </span>
            <h2>Profile</h2>
          </div>

          <div id="manuopt" onclick="dataopt()" class="sidebarOption">
            <span class="material-icons"> more_horiz </span>
            <h2>More</h2>
          </div>
          <button class="sidebar__tweet">Tweet</button>
        </div>

        <div>

        </div class="bottomdata datastick">
         
        <div class="profile_row">
          <div class="profile_tab1">
            <img src="<%=profile_data.user_image%>">
          </div>
          <div class="profile_tab2">
            <p><%=profile_data.name%></p>
            <p><%=profile_data.user_name%></p>
          </div>
        </div>
        <%-include("staticpart1")-%>
      </div>
      <!-- sidebar ends -->

      <!-- feed starts -->
      <div class="feed">



        <div class="feed__header">
          <div class="header" id="myHeader">





            <div class="unameandarroo">


              <div onclick="history.back()" class="arrowicon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                  width="32" height="32" viewBox="0 0 256 256" xml:space="preserve">

                  <defs>
                  </defs>
                  <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;"
                    transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                    <polygon points="65.36,0 69.64,4.28 28.92,45 69.64,85.72 65.36,90 20.36,45 "
                      style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"
                      transform="  matrix(1 0 0 1 0 0) " />
                  </g>
                </svg>
              </div>

              <div>

                <h2> <%=profile_data.name%>  </h2>
                <p class="lighttxt"><%=tweet_count%> Tweets</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- tweetbox starts -->
        <div class="feed-contain">
          <div class="mainprofile">


            <div class="card">
              <div class="card_background_img">

              </div>
              <div class="card_profile_img">
              <img src="<%=profile_data.user_image%>">
              </div>
              <div class="user_details">
                <div class="unameinpro">

                  <h3><%=profile_data.name%> </h3>
                  <h4><%=profile_data.user_name%> </h4>
                </div>


                <div class="editpro">
                  <a class="editproa"> Edit Profile </a>
                  <a  href="/prof/profedit" class="editproa"> Edit Profile </a>
                </div>
              </div>

              <div class="follow">
                <div class="flexthisdata">
                  <div class="lfmargin">
                    <i class="fa fa-calendar" aria-hidden="true"></i>
                   

                    <img width="20" src="/public/files/1a83c828b67134a9b2ab348a0fb5d807" alt="calander">
                  </div>
                  <div class="joindate">
               
                    <h4> 
                      joined March @2023</h4>
                  </div>
                </div>
                <div class="flexthisdata">
                  <div class="lfmargin">
                    <h4> <%=count%> <a href="/list/following">Following</a>&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp </h4>
                  </div>
                  <div>
                    <h4><%=f%><a href="/list/follower"> Followers</a></h4>
                  </div>


                </div>
              </div>
            </div>

          </div>

          <!-- tweetbox ends -->

          <!-- post starts -->
          <div class="post">


            <div class="post-child">
              <%
              const array_of_allowed_files = ['png', 'jpeg', 'jpg'];
              const array_of_allowed_videos = ['mp4','gif'];
          %>
          <% for(var i=0;i<data.length;i++) { %>
              <div class="flexdatatwit">


                <div class="twitimg">

                  <img width="32px" class="tweetimg1" src="<%=profile_data.user_image%>" alt="img">
                  <img width="32px" class="tweetimg1" src="/public/files/1a83c828b67134a9b2ab348a0fb5d807" alt="img">
                </div>



                <div class="nameandtime">

                  <div class="flex1">

                    <div class="tweetname">

                      <h5 class="tweetnamed">
                        <%=profile_data.name%>
                      </h5>
                    </div>
                    <div class="tweetid">
                      <h5 class="tweetidd">
                        <%=profile_data.user_name%>
                      </h5>
                    </div>
                   


                  </div>
                  <div class="tweetdatamain">

                    <h5 class="tweetdatatxt">
                            <div>
                                    <div>
                                       

                                            <p class="skill"><%=data[i].description%></p>
                                            <%  if(data[i].media_url==null) {   
                                                console.log("nothing")
                                             }else{ 
                                            %>
                                            <%  const file_extension = data[i].media_url.slice(((data[i].media_url.lastIndexOf('.') - 1) >>> 0) + 2);
                                                if (array_of_allowed_files.includes(file_extension)) {
                                            %>
                                            <img id="tweet_img"  src="<%=data[i].media_url%>" />
                                            <div>
                                              <div class="insta">
                                                  <div class="icon_row">
                                                    <div class="icon_tab">
                                                      <i id="heart1" class="fa fa-thumbs-up" onclick="likepost()"></i>
                                                     
                                                      <p><%=arr2[i]%></p>
                                                     
                                                    </div>
                                                     
                                                    <div class="icon_row">
                                                      <div class="icon_col1">
                                                          <a href=""><i  class="fas fa-comment"></i></a>
                                                          <p><%=arr3[i]%></p>
                                                      </div>
                                                      
                                                    <div class="icon_row">
                                                      <div class="icon_col2">
                                                          <a href=""><i class="fa fa-retweet"></i></a>
                                                    <p>10</p>
                                                      </div>
                                                     
                                                  </div>
                                                 
                                               </div>
                                          </div>
                                            <% }else{ %>
                                                <video width="320" height="240" controls>
                                                    <source src="<%=data[i].media_url%>" type="video/mp4">
                                                </video>
                                                <div>
                                                  <div class="insta">
                                                      <div class="icon_row">
                                                          <i id="heart<%=i%>" class="fa fa-thumbs-up" onclick="likepost()"></i>
                                                          <p>10</p>
                                                        <div class="icon_row">
                                                          <div class="icon_col1">
                                                              <a href=""><i  class="fas fa-comment"></i></a>
                                                              <p>10</p>
                                                          </div>
                                                          
                                                        <div class="icon_row">
                                                          <div class="icon_col">
                                                              <a href=""><i class="fa fa-retweet"></i></a>
                                                        <p>10</p>
                                                          </div>
                                                         
                                                      </div>
                                                     
                                                   </div>
                                              </div>
                                            <% }}%>
                                            
                                        
                                    </div>
                      
                            </div>
                        </div>
                        </div>
                        
              
                    </h5>
                  </div>
                </div>
              </div>
            <%}%>
            </div>


          </div>



        </div>
      </div>


      <!-- feed ends -->

      <!-- widgets starts -->
      <div class="widgets">
       
  <%-include("staticpart2")-%>
      </div>
    </div>
  </div>
  <!-- widgets ends -->
  </div>
  <dialog id="moreoption">
    <div class="manubar">
      <a class="achange" href="http://localhost:8000/changepassword"> Change Password</a>
      <a class="achange" href="/changepassword/changepassword"> Change Password</a>
      <a class="achange" id="deleteac" onclick="deleteac()">Delete Account</a>
      <a class="achange" id="logoutac" onclick="logoutac()">Logout</a>

      <p class="cancel" onclick="dataout()">cancle</p>
    </div>
  </dialog>
  <script>

    function dataopt() {

      var data1 = document.getElementById('moreoption')
      data1.showModal()
    }
    function dataout() {
      var data1 = document.getElementById('moreoption')
      data1.close()
    }








    window.onscroll = function () { myFunction() };

    var header = document.getElementById("myHeader");


    var sticky = header.offsetTop;

    function myFunction() {
      if (window.pageYOffset > sticky) {
        header.classList.add("sticky");
      } else {
        header.classList.remove("sticky");
      }
    }








    async function del(abc) {
      x = parseInt(abc)
      console.log(x)

      var text = "you really want to delte this record" + x;
      if (confirm(text) == true) {
        text = "you really want to delte this record", x;
        fetch('/delete?id=' + x, {
          method: 'post',
          headers: {
            "Content-type": 'application/json'
          },
          body: JSON.stringify({
            id: x
          })
        })

          .then(res => res.json())
          .then(data => {
            document.getElementById(x).style.display = 'none';
            //console.log(data.result.length);
            console.log(data)
            console.log("data delete sucesfully!!!!")
            location.reload()
          })
      }
    }


    // var likeobj = 0;
    var count = 0
    var flag = true
    function likepost() {
      var count2=document.getElementById("count").innerHTML
      console.log(count2)
        var z=document.getElementById('heart1')
        count=1
        
        if(flag==true){
            z.style.color='red'
          flag=false;
        }else{
          z.style.color='#e0e2e4'
          flag=true;
        }
    }
















    function dataopt() {

var data1 = document.getElementById('moreoption')
data1.showModal()
}
function dataout() {
var data1 = document.getElementById('moreoption')
data1.close()
}








window.onscroll = function () { myFunction() };

var header = document.getElementById("myHeader");


var sticky = header.offsetTop;

function myFunction() {
if (window.pageYOffset > sticky) {
  header.classList.add("sticky");
} else {
  header.classList.remove("sticky");
}
}


function logoutac() {


if (confirm("are your sure to logout") == true) {
      fetch(`/logout/logout`)
      location.assign(`/login/login/index5`)
      console.log("delete")
} else {
      alert("you cancel the delete");
}

}


async function deleteac() {

if (confirm("are your sure to Delete Account") == true) {
 const data=   await  fetch(`/deleteAccount/delete`);
 const data2 = await data.json();
 console.log(data2);
      window.location.href="/login/login/index5"
      console.log(data2);
} else {
      alert("you cancel the delete");
}

}


// var likeobj = 0;
var count=0
var flag=true
function likepost() {
  var z=document.getElementById('heart1')
  count=1
  
  if(flag==true){
      z.style.color='red'
    flag=false;
  }else{
    z.style.color='#e0e2e4'
    flag=true;
  }
}
  </script>
</body>

</html>