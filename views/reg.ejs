<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body class="body-login">
  <div class="main">
    <div class="container">
      <div class="main_row">
        <div class="main_tab">
          <div class="main_col">
            <form action="/registration/register" onsubmit="return prachi1()" method="post" class="form1">
              <div class="signpage">
                <div class="signchild">
                  <div class="textdata">
                    <div class="twi">
                      <svg class="svg-icon2"
                        style="width: 2em; height: 2em;vertical-align: middle;fill: currentColor;overflow: hidden;"
                        viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                        <path
                          d="M962.267429 233.179429q-38.253714 56.027429-92.598857 95.451429 0.585143 7.972571 0.585143 23.990857 0 74.313143-21.723429 148.260571t-65.974857 141.970286-105.398857 120.32-147.456 83.456-184.539429 31.158857q-154.843429 0-283.428571-82.870857 19.968 2.267429 44.544 2.267429 128.585143 0 229.156571-78.848-59.977143-1.170286-107.446857-36.864t-65.170286-91.136q18.870857 2.852571 34.889143 2.852571 24.576 0 48.566857-6.290286-64-13.165714-105.984-63.707429t-41.984-117.394286l0-2.267429q38.838857 21.723429 83.456 23.405714-37.741714-25.161143-59.977143-65.682286t-22.308571-87.990857q0-50.322286 25.161143-93.110857 69.12 85.138286 168.301714 136.265143t212.260571 56.832q-4.534857-21.723429-4.534857-42.276571 0-76.580571 53.979429-130.56t130.56-53.979429q80.018286 0 134.875429 58.294857 62.317714-11.995429 117.174857-44.544-21.138286 65.682286-81.115429 101.741714 53.174857-5.705143 106.276571-28.598857z"
                          fill="#857df9" />
                      </svg>
                    </div>

                    <input type="text" name="name" id="namee" class="squre" placeholder="Name" />
                    <p id="error1"></p>


                    <input type="text" name="email" id="emaill" class="squre" onchange="prachi2(this.value)"
                      placeholder="   Email" />
                    <p id="error2"></p>

                    <input type="text" name="username" id="username" class="squre" onchange="prachi3(this.value)"
                      placeholder="   User Name" />
                    <p id="error5"></p>

                    <input type="password" name="password" id="pass" class="squre" placeholder="   Password" />
                    <p id="error3"></p>


                    <input type="password" name="con_password" id="con_pass" class="squre"
                      placeholder="   Conform password" />
                    <p id="error4"></p>


                    <input type="submit" id="sub" class="submit-login" value="Sign up" />


                    <p id="account">Already have an account?<a href="/login/login" class="aforlink">Login Here.</a> </p>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

  </div>
  </div>
  </div>
  <script>

    function prachi1() {

      let name = document.getElementById("namee").value;
      let email = document.getElementById("emaill").value;
      let password = document.getElementById("pass").value;
      let con_password = document.getElementById("con_pass").value;

      if (name == "") {
        document.getElementById("error1").innerHTML = "Please enter valid name";
        return false;
      }
      else {
        document.getElementById("error1").innerHTML = "";

      }

      var regex = /^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+$/;
      var email2 = regex.test(email);
      if (email == "" || !(email2)) {
        document.getElementById("error2").innerHTML = "Please enter valid email";
        return false;
      }
      else {
        document.getElementById("error1").innerHTML = "";

      }

      var regex1 = /((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[\W]).{6,20})/;
      var pass1 = regex1.test(password);
      if (password == "" || !(pass1)) {
        document.getElementById("error3").innerHTML = "Please enter valid password that contain capital alphabet,small alphabet,special character,length(6-20)";
        return false;
      }
      else {
        document.getElementById("error1").innerHTML = "";

      }
      if (con_password != password) {
        document.getElementById("error4").innerHTML = "Password doesn't match";
        return false;
      }
      else {
        document.getElementById("error1").innerHTML = "";

      }
    }


    async function prachi2(card) {

      var change = await fetch(`/registration/register/email?email=${card}`);
      var change2 = await change.json();

      console.log("email checking: ", change2.data);
      if (change2.data != "") {
        var btn = document.getElementById("sub")
        btn.disabled = true
        document.getElementById("error2").innerHTML = "email already exist";
      }
      else {
        document.getElementById("error2").innerHTML = "";
        var btn = document.getElementById("sub")
        btn.disabled = false
      }
    }


    async function prachi3(card) {

      var change = await fetch(`/registration/register/username?userName=${card}`);
      var change2 = await change.json();

      console.log("user name checking: ", change2.data);
      if (change2.data != "") {
        document.getElementById("error5").innerHTML = "user name already exist";
        var btn = document.getElementById("sub")
        btn.disabled = true
      }
      else {
        document.getElementById("error5").innerHTML = "";
        var btn = document.getElementById("sub")
        btn.disabled = false
      }
    }

  </script>
</body>

</html>